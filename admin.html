<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOKEN LOGIN - ADMIN PANEL</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', Arial, sans-serif; background: #f0f2f5; color: #333; }
        .header { background: #000; color: #fff; padding: 25px; text-align: center; font-size: 22px; font-weight: bold; }
        .container { max-width: 500px; margin: 40px auto; background: #fff; padding: 35px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .input-group { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }
        input[type="password"] { width: 100%; padding: 15px; border: 2px solid #ddd; border-radius: 8px; box-sizing: border-box; font-size: 14px; transition: 0.3s; }
        input[type="password"]:focus { border-color: #000; outline: none; }
        .upload-area { border: 2px dashed #bbb; padding: 40px; text-align: center; margin-bottom: 20px; cursor: pointer; background: #fafafa; border-radius: 10px; transition: 0.3s; }
        .upload-area:hover { border-color: #000; background: #fff; }
        #fileList { font-size: 13px; color: #666; max-height: 150px; overflow-y: auto; background: #f9f9f9; padding: 12px; border: 1px solid #eee; margin-bottom: 20px; border-radius: 6px; }
        .btn { background: #000; color: #fff; padding: 18px; border: none; width: 100%; cursor: pointer; font-weight: bold; border-radius: 8px; font-size: 16px; transition: 0.3s; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        .btn:hover:not(:disabled) { background: #333; }
        .status { margin-top: 20px; padding: 15px; border-radius: 8px; display: none; text-align: center; font-weight: bold; font-size: 14px; }
        .loading { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
    </style>
</head>
<body>

<div class="header">GITHUB CLOUD UPLOADER</div>

<div class="container">
    <div class="input-group">
        <label>Enter GitHub Token:</label>
        <input type="password" id="ghToken" placeholder="ghp_... kodunuzu buraya yapıştırın">
    </div>

    <div class="upload-area" onclick="document.getElementById('fileInp').click()">
        <strong>Click to Select Files</strong>
        <p>JPG, EPS, SVG, JSON</p>
    </div>
    <input type="file" id="fileInp" multiple style="display:none" onchange="handleSelection(this.files)">

    <div id="fileList" style="display:none"></div>
    <div id="statusBox" class="status"></div>
    
    <button class="btn" id="uploadBtn" onclick="processUpload()" disabled>SYNC TO CLOUD</button>
</div>

<script>
    // --- SABİT AYARLAR ---
    const GITHUB_USER = "free-vector-stock";
    const GITHUB_REPO = "free-vector-stock";
    // ---------------------

    let filesToProcess = [];

    function handleSelection(files) {
        filesToProcess = Array.from(files);
        const list = document.getElementById('fileList');
        if(filesToProcess.length > 0) {
            list.style.display = "block";
            list.innerHTML = "<strong>Selected:</strong><br>" + 
                             filesToProcess.map(f => `• ${f.name}`).join('<br>');
            document.getElementById('uploadBtn').disabled = false;
        }
    }

    async function processUpload() {
        const token = document.getElementById('ghToken').value.trim();
        const status = document.getElementById('statusBox');
        const btn = document.getElementById('uploadBtn');

        if(!token.startsWith('ghp_')) {
            alert("Hata: Lütfen ghp_ ile başlayan geçerli bir token girin.");
            return;
        }

        status.style.display = "block";
        status.className = "status loading";
        status.innerText = "Connecting to GitHub... Sending files.";
        btn.disabled = true;

        try {
            for (let file of filesToProcess) {
                const base64 = await new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = () => resolve(reader.result.split(',')[1]);
                    reader.readAsDataURL(file);
                });

                const url = `https://api.github.com/repos/${GITHUB_USER}/${GITHUB_REPO}/contents/assets/${file.name}`;
                
                // SHA kontrolü (Aynı dosya varsa üzerine yazar)
                const checkRes = await fetch(url, { headers: { 'Authorization': `token ${token}` } });
                let sha = null;
                if (checkRes.ok) {
                    const data = await checkRes.json();
                    sha = data.sha;
                }

                const uploadRes = await fetch(url, {
                    method: 'PUT',
                    headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        message: `Upload: ${file.name}`,
                        content: base64,
                        sha: sha
                    })
                });

                if(!uploadRes.ok) throw new Error(`${file.name} failed!`);
            }

            status.className = "status success";
            status.innerText = "SUCCESS! Everything uploaded to GitHub.";
            
        } catch (err) {
            status.className = "status error";
            status.innerText = "ERROR: " + err.message;
            btn.disabled = false;
        }
    }
</script>
</body>
</html>
