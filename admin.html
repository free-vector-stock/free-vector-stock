<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>FREE VECTOR STOCK - ADMIN CLOUD SYNC</title>
    <style>
        body { font-family: sans-serif; background: #fff; margin: 0; padding: 0; }
        .header { background: #000; color: #fff; padding: 30px; text-align: center; font-weight: 900; letter-spacing: 2px; }
        .box { max-width: 700px; margin: 50px auto; padding: 40px; border: 1px solid #eee; box-shadow: 0 10px 40px rgba(0,0,0,0.05); }
        input[type="password"] { width: 100%; padding: 15px; margin-bottom: 20px; border: 1px solid #ddd; outline: none; }
        .drop-zone { border: 2px dashed #ccc; padding: 50px; text-align: center; color: #888; cursor: pointer; background: #fafafa; border-radius: 10px; }
        .drop-zone:hover { border-color: #000; background: #fff; }
        button { width: 100%; padding: 20px; background: #000; color: #fff; border: none; font-weight: bold; cursor: pointer; margin-top: 20px; text-transform: uppercase; }
        #log { margin-top: 20px; font-size: 12px; height: 200px; overflow-y: auto; background: #f4f4f4; padding: 10px; border-radius: 5px; }
    </style>
</head>
<body>

<div class="header">FREE VECTOR STOCK - CLOUD MANAGEMENT</div>

<div class="box">
    <label>GITHUB TOKEN:</label>
    <input type="password" id="token" placeholder="Enter ghp_ your secure token">
    
    <div class="drop-zone" onclick="document.getElementById('fileInp').click()">
        <strong>CLICK TO BULK SELECT ASSETS</strong>
        <p>You can select JPG, EPS, SVG and JSON files simultaneously.<br>Systems will match them automatically by name.</p>
    </div>
    <input type="file" id="fileInp" multiple style="display:none" onchange="showStats()">

    <div id="log">No files selected.</div>
    <button onclick="startSync()">START BULK CLOUD SYNC</button>
</div>

<script>
    const OWNER = "free-vector-stock", REPO = "free-vector-stock";
    
    function showStats() {
        const count = document.getElementById('fileInp').files.length;
        document.getElementById('log').innerText = count + " files ready to sync.";
    }

    async function startSync() {
        const token = document.getElementById('token').value;
        const files = Array.from(document.getElementById('fileInp').files);
        const log = document.getElementById('log');

        if(!token || files.length === 0) return alert("Token or files missing!");

        log.innerHTML = "Sync process started...<br>";

        for(let file of files) {
            try {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                await new Promise((resolve) => {
                    reader.onload = async () => {
                        const base64 = reader.result.split(',')[1];
                        const path = `assets/${file.name}`;
                        
                        // Check if file exists to get SHA (for update)
                        let sha = null;
                        const check = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${path}`, {
                            headers: { 'Authorization': `token ${token}` }
                        });
                        if(check.ok) { const data = await check.json(); sha = data.sha; }

                        const res = await fetch(`https://api.github.com/repos/${OWNER}/${REPO}/contents/${path}`, {
                            method: 'PUT',
                            headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                message: "Cloud Sync: " + file.name,
                                content: base64,
                                sha: sha
                            })
                        });

                        if(res.ok) log.innerHTML += `<span style="color:green">✓ SYNCED: ${file.name}</span><br>`;
                        else log.innerHTML += `<span style="color:red">✗ FAILED: ${file.name}</span><br>`;
                        
                        log.scrollTop = log.scrollHeight;
                        resolve();
                    };
                });
            } catch(e) { log.innerHTML += `<span style="color:red">✗ ERROR: ${file.name}</span><br>`; }
        }
        log.innerHTML += "<strong>PROCESS COMPLETED.</strong>";
    }
</script>
</body>
</html>
