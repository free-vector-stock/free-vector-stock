<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ADMIN PANEL - FREE VECTOR STOCK</title>
    <style>
        body { font-family: sans-serif; background: #fff; margin: 0; padding: 40px; }
        .box { max-width: 600px; margin: 0 auto; padding: 30px; border: 1px solid #eee; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        h1 { border-bottom: 2px solid #000; padding-bottom: 10px; font-size: 20px; text-transform: uppercase; }
        input[type="password"] { width: 100%; padding: 12px; margin: 20px 0; border: 1px solid #ddd; }
        .drop { border: 2px dashed #ccc; padding: 40px; text-align: center; cursor: pointer; background: #fafafa; }
        .drop:hover { border-color: #000; background: #fff; }
        #log { margin-top: 20px; font-size: 13px; max-height: 200px; overflow-y: auto; }
        .btn { width: 100%; padding: 15px; background: #000; color: #fff; border: none; font-weight: bold; cursor: pointer; margin-top: 20px; text-transform: uppercase; }
        .ok { color: green; } .err { color: red; }
    </style>
</head>
<body>

<div class="box">
    <h1>GitHub Cloud Uploader</h1>
    <input type="password" id="tk" placeholder="Enter GitHub Token (ghp_...)">
    
    <div class="drop" onclick="document.getElementById('f').click()">
        <strong>Click to Select Files</strong>
        <p>Bulk Upload: JPG, EPS, SVG, JSON</p>
    </div>
    <input type="file" id="f" multiple style="display:none" onchange="list()">

    <div id="log"></div>
    <button class="btn" onclick="sync()">Sync to Cloud</button>
</div>

<script>
    let files = [];
    const U = "free-vector-stock", R = "free-vector-stock";

    function list() {
        files = Array.from(document.getElementById('f').files);
        document.getElementById('log').innerHTML = `<strong>Selected:</strong> ${files.length} files.`;
    }

    async function sync() {
        const token = document.getElementById('tk').value;
        const log = document.getElementById('log');
        if(!token) return alert("Token required!");

        log.innerHTML = "<em>Starting upload...</em><br>";

        for(let file of files) {
            try {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                await new Promise(res => {
                    reader.onload = async () => {
                        const content = reader.result.split(',')[1];
                        const path = `assets/${file.name}`;
                        
                        let sha = null;
                        const check = await fetch(`https://api.github.com/repos/${U}/${R}/contents/${path}`, {
                            headers: { 'Authorization': `token ${token}` }
                        });
                        if(check.ok) { const d = await check.json(); sha = d.sha; }

                        const up = await fetch(`https://api.github.com/repos/${U}/${R}/contents/${path}`, {
                            method: 'PUT',
                            headers: { 'Authorization': `token ${token}`, 'Content-Type': 'application/json' },
                            body: JSON.stringify({ message: `Admin upload: ${file.name}`, content, sha })
                        });

                        if(up.ok) log.innerHTML += `<div class="ok">✓ ${file.name} uploaded.</div>`;
                        else log.innerHTML += `<div class="err">✗ ${file.name} failed.</div>`;
                        res();
                    };
                });
            } catch(e) { log.innerHTML += `<div class="err">✗ Error: ${file.name}</div>`; }
        }
        log.innerHTML += "<strong>Completed.</strong>";
    }
</script>
</body>
</html>
